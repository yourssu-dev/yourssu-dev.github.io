---
title: "git 으로 협업을 시작하자 - 초중급자용"
date: 2021-01-24T15:30:00+09:00
draft : false
categories : ["git"]
tags : ["git", "협업", "개발", "초중급자"]
author : ["MintPark"]
---

## 서론

안녕하세요 오랜만에 돌아온 유어슈의 안드로이드 개발자 박정현입니다. </br>
오늘은 깃에 대해서 이야기 해볼까 합니다.

이런 말을 하면 '갑자기 왠 git?? 그건 당연히 개발하려면 알아야 하는거 아닙니까?' 라는 분도 계실거 같아요.</br>
이 글을 쓰기 시작한 이유부터 말씀드려야 할거 같군요.

유어슈는 대학교 동아리에서 운영되는 단체입니다. 일부 몇명을 제외하고는 당연히 사람이 빨리 빠지고 다시 들어오는 구조입니다 즉 교체가 자주 됩니다.</br>
즉 빠르게 배우고 빠르게 협업해야 합니다! 근데 대학생이잖아요.... 솔직히 깃 시스템에 대해서 얼마나 알고 들어올까요? 
대부분 잘 모릅니다 ㅠㅜ

물론 그냥 혼자 개발하는 법은 금방합니다. 문제는 여러사람이 개발하는 이 상황이겠죠 네 컨플릭이 문제였어요.</br>
컨플릭이 안나면 좋겠지만 그럴리는 없죠. 일반적인 대학생 과제는 혼자 하는 경우가 대부분이여서 그럴까요? 컨플릭이 발생했을 때 혼자 해결하시는 분이 적었습니다.</br>
그때마다 같이 해결해 주면서 주의점과 해결법을 알려주긴 하지만 매번 이렇게 알려주긴 힘들다는 생각이 들더군요.

그래서 이렇게 글로 정리해보게 되었습니다 🤗

## 배울 것

이번 포스트를 통해 어떤 것을 알려줘야 할지 고민을 해봤습니다. 일단 목록부터 보시면

- git rebase (--continue|--abort)
- git merge

별게 없죠? 사실 많은게 필요한게 아니라고 생각합니다. 그리고 솔직히 제 개인적인 취향도 들어가 있습니다. </br>
근데 솔직히 말해서요 저는 뭘 배우는지 보단 어떻게 배우는지가 중요하다고 생각하는 사람입니다. </br> 
이번 포스트를 통해서 여러분의 머리속에 확실하게 개념을 집어 넣어드릴겁니다.

그래서 실제 상황에 맞춰서 가르쳐 드릴겁니다 기존의 정립된 시스템? 정확한 용어나 개념? 그것보단 비유와 보기 쉬운 설명으로 확실하게 정리해 드릴겁니다.

% 본 글은 터미널을 기준으로 작성되었습니다 각자 사용하는 git 도구에서 어떻게 사용하는지는 개인적으로 알아보시길 %

# 본론
자 시작해 봅시다 이 글은 초중급자용입니다 제 생각에 초중급자는 git add commit push 의 개념은 잘 알고 있다는 사람이 기준입니다

우선 컨플릭은 왜 발생하는 걸까요?

간단하게는 원격 브랜치와 내 로컬 브랜치가 같은 내용을 수정했을때 발생합니다. 나 혼자 개발하는게 아니니까요. 당연하죠.

근데 보통은 이걸 생각하지 못합니다. 내 부분만 잘 하면 컨플릭이 안날것이다!!!! 바보같은 믿음입니다 어떻게든 납니다 띄어쓰기 하나로도.

자 상황을 고려해보죠 새로 들어온 유어슈 신입 개발자!!! 그라운드 클론 한번 받아보고 코드 좀 보고 인큐베이팅 좀 진행해보고 초반에 공부할게 많으니 이것저것 배워봅니다.</br>
이 신입개발자는 이러쿵저러쿵 성장을 해서 드디어 첫 작업에 들어가게 되었어요. </br>
마침 예전에 클론해둔 그라운드 레포도 있겠다 바로 develop에서 새 브랜치를 만들어서 작업을 시작하게 됩니다.</br>
즉 처음 클론을 받고 나중에 작업을 시작하면서 그때 당시 작업내용에서 작업을 시작합니다.</br>
그동안 변경된게 있을테니 pull을 받고 시작하는게 더 도움이 될텐데 말이죠.</br>
하지만 안타까운 유어슈 신입이 이미 작업을 시작했네요. </br>
그럼 내가 작업하고 있는동안 다른사람들이 develop 브랜치에 작업을 추가 해둔 상황이라고 가정해보죠.(그것도 공통으로 쓰는 코어부분을!!)

자 신입이의 미래는 어떻게 될까요. 당연한 결과겠죠 컨플릭이 날겁니다. </br>
왜냐면 원격 브랜치가 변경된다고 내 로컬에도 반영되는게 아니니까 다른 사람이 개발을 할수록 원격 브랜치의 내용과</br>
로컬 브랜치의 내용이 달라질테니까요. 변화가 클 수록 더 많은 부분이 더 자주 컨플릭이 발생합니다. </br>
여기서 우리가 깨달아야 할건 원격브랜치와 로컬브랜치의 차이가 적을수록 컨플릭이 덜 난다는 사실이죠.</br>
뭐 이미 발생한 컨플릭은 어쩔수 없고 해결을 해야겠죠 변경된 작업내용을 내 브랜치에 반영하는 작업을 하면 됩니다.</br>
우선 첫번째로 할 일은 무엇일까요? 간단하게 생각해 봅시다 우리는 develop 브랜치에 PR(MR)을 날려서 머지시키는게 목표입니다. </br>
근데 일단 원격 브랜치의 develop과 로컬 브랜치의 develop이 같은 상태일까요?</br>
네 첫번째로 할 일은 develop을 최신화 시키는 일입니다. 'git checkout develop' -> 'git pull' or 'git pull origin develop' </br>
최신화를 시켜야 최신 develop 브랜치와 내 브랜치의 차이를 알 수 있게 되는것입니다.

그 다음은 develop의 변경사항을 내가 올리고 싶은 브랜치에 적용하는 과정이 필요합니다 </br>
크게 두가지 방법이 있다고 생각합니다 

1. develop 의 변경사항을 내 브랜치로 merge 한다.
2. 내 브랜치의 분기점을 현재시점으로 rebase 한다.

흠 이제 슬슬 헷갈리기 시작했나요? 자 그럼 이해하기 쉽게 특정 작업에 대해서 순서를 가정해 볼까요

원래 develop에는 과거 부터 순서대로 a - b - c - d 라는 작업내용이 있었습니다.</br>
신입이는 develop에 이어서 e - f 라는 작업내용을 작업하고 있었어요.</br>
근데 다른 사람들이 g - h 라는 작업을 해서 머지를 해버렸네요. </br>
그 뒤 신입이는 자신의 작업내역을 푸시하고 머지를 하려했지만 컨플릭이 발생!!</br>
그럼 현재 원격 브랜치의 상황은? develop은 a - b - c - d - g - h 라는 상황, 원격의 본인 브랜치는? a - b - c - d - e - f이군요.</br>
만약 컨플릭이 안나고 신입이의 코드도 들어갔다면 a - b - c - d - g - h - e - f 가 되었을까요?</br>
그건 모릅니다 커밋시간 스쿼시 커밋 영향 등 여러가지 조건을 따지거든요.</br>
하지만 우리는 쉽게 생각하기 위해서 a - b - c - d - g - h - e - f 가 된다고 가정해 봅시다. (쉽게 이해하기 위해서입니다)</br>
근데 컨플릭이라는건 g - h 와 e - f 의 내용이 같은 부분을 수정해서 어느쪽의 코드가 맞는지 모르는 경우에 발생하는 겁니다 모르겠다 개발자인 너가 정해달라!! 

위의 두가지 방법의 차이점은 여기서 발생한다고 생각합니다. 

1번 방법은 내 브랜치 a - b - c - d - e - f 에 g - h 라는 작업내역을 반영!!</br>
2번 방법은 원래 분기 되었던 기준 a - b - c - d 가 아니라 현재 a - b - c - d - g - h 를 기준으로 e - f 라는 작업내역을 반영하는거죠

저는 개인적으로 2번을 선호합니다. </br>
현재 실행이 잘 되는 코드를 기준으로 내 코드를 추가하는 방식이 안전하다고 생각하기도 하고 작업 브랜치가 깔끔해지기 때문이죠 물론 사람마다 다른 부분이긴 합니다</br>
(머지 되었을때를 기준으로 1번은 develop이 내 브랜치에 develop이 부어지고 다시 develop으로 가는 반면 2번은 분기점만 다시 생성되고 깔끔하게 되돌아가기 때문)

1번은 간단하게 본인 브랜치로 돌아와서 최신화된 develop을 부어주기 위해서 'git merge develop'을 하면 됩니다. 그 후 컨플릭을 수정하고 다시 올리면 되는거죠.</br>
이 포스트에서 말하고 싶은건 2번입니다 하나씩 살펴보죠.

일단 명령어는 'git rebase develop' 입니다 그러면 본인의 작업내역을 롤백 후 현재 최신 develop 을 기준으로 헤드를 이동 자신의 작업내역을 한커밋씩 적용해나가기 시작합니다. </br>
그니까 일단 a - b - c - d - g - h 를 만들어 놓고 e - f 를 적용해나가기 시작한다는거죠.

여기서 컨플릭이 없다면 그냥 한번에 쫙 하고 적용이 됩니다! 다만 컨플릭이 이미 난 상황이죠. </br>
그러면 한 커밋씩 적용하던 과정에서 중간에 멈추고 컨플릭을 해결하라고 알람이 뜹니다.</br>
터미널 기준으로는 현재 브랜치가 커밋번호로 바뀌면서 conflict 이라고 뜨기도 하고 </br>
rebase[1/7] 이런식으로 처리해야할 컨플릭 수를 보여주기도 합니다 안드로이드 스튜디오는 붉은색으로 오류난 부분을 알려주죠.</br>
이 과정은 최신화를 안한 만큼 다른사람이 작업을 한 양 만큼 길어지게 될 것입니다. </br>
일단 컨플릭이 난 부분은 빨간색으로 표시되니 수정을 하고 'git add .' 을 사용해 수정된 내용을 알려주고 'git rebase --continue'로 중단된 리베이스를 계속 진행합니다. </br>
그리고 리베이스 과정이 끝날때 까지 일련의 과정을 반복합니다 '수정' -> 'git add .' -> 'git rebase --continue' 하다보면 원래 브랜치로 돌아오면서 완료가 됩니다.

(만약 중간에 실수로 잘못 고치거나 오류가 심각해져서 돌려야한다면 'git rebase --abort' 를 사용해서 돌립니다 리베이스 하기 전으로 돌아갑니다.

자 다 완료가 되었습니다. 드디어 원격의 작업내역을 내 브랜치로 적용했군요. </br>
그럼 현재 본인의 로컬 브랜치는 어떤 상태일까요? 아까의 가정대로 a - b - c - d - g - h - e - f 가 되었을 겁니다.</br>
그래서 푸시를 하려고 하는 신입이!!! 근데 왠 충돌?! 정답은 아까 컨플릭을 수정하기 전에 올린 push 때문이군요. </br>
아까 현재 원격 브랜치의 상태는 어떤 상황이죠?</br>
위를 다시 보시면 알겠지만 a - b - c - d - e - f 이라는 상황이고 내 로컬 브랜치는 a - b - c - d - g - h - e - f 이러한 상황입니다.</br>
네 적용 순서가 다르니 원격으로 합칠 수가 없군요.</br>
여기서 만약 충돌 해결한다고 pull을 하게 되면?? 리베이스 다시 돌아가고 처음부터 다시 할 수도 있습니다. 그럼 어떻게 해야할까요? 그냥 간단하게 생각해보세요.</br>
내 로컬이 무조건 맞는 순서의 커밋들이니까 포스 푸시를 하는걸 권장드려요 제일 간단합니다. 'git push -f origin 본인브랜치이름' 그럼 해결 ~

이상으로 컨플릭과 깃에 대한 원인과 이유 제 나름대로의 해결법을 적어드렸는데요 포스푸시도 그렇고 그렇게 좋아하지 않는 분들도 있을수 있어요 </br>
근데 develop이나 master같은 중요한 브랜치가 아니라 본인 브랜치라면 저는 간단한 해결법이라고 생각합니다</br>
중요한것은 깃을 잘 이해하고 본인만의 방법을 만들어가는거겠죠. 이 글은 그냥 서포트죠.

## 정리
### 컨플릭 수정법과 예방법은 동일하다
- develop을 항상 최신상태로 유지하고 작업하는 중간중간 rebase 하는 습관을 들이자 (컨플릭이 없다면 쉽게 끝난다)
- PR(MR)은 자주자주 날린다, PR(MR)은 작은 단위로 날린다, 브랜치를 여러개 만들어서 활용하자(1번 브랜치 PR(MR)을 보내놓고 2번 브랜치에서 다른작업을 하자)
